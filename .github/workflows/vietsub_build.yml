# This is a basic workflow to help you get started with Actions

name: vietsub_build

on:
  workflow_dispatch:
  watch:
    types: [started]
    
env:              
  ROM_URL: 'https://bigota.d.miui.com/21.11.17/miui_BEGONIA_21.11.17_c05ad0fe41_11.0.zip'
  Zip_name: 'MIUI_VietSub_BEGONIA_21.11.17_c05ad0fe41_11.0.zip'
  
jobs:
  build:
    runs-on: ubuntu-latest

    steps:
       - name: Checkout
         uses: actions/checkout@main
       
       - name: Clean Up
         run: |       
           docker rmi `docker images -q`
           sudo rm -rf /usr/share/dotnet /etc/mysql /etc/php /etc/apt/sources.list.d
           sudo -E apt-get update
           sudo -E apt-get -y autoremove --purge
           sudo -E apt-get clean
           df -h
           
       - name: Setting up the SPICES
         run: |
            sudo apt-get install -y git wget git zip unzip img2simg
       - name: Cloning...
         run: |
             git clone -b action https://github.com/buihien224/MIUI_VIETSUB.git $GITHUB_WORKSPACE/MIUI_VIETSUB
           
       - name: Download zip... and run
         run: |
            cd $GITHUB_WORKSPACE/MIUI_VIETSUB
            chmod +x download.sh
            chmod +x bhlnk.sh
            sudo bash download.sh $ROM_URL 
            mv MIUI_VIETSUB.zip $Zip_name
       - name: Upload a file to Google Drive
         uses: willo32/google-drive-upload-action@v1
         with:
          target: $GITHUB_WORKSPACE/MIUI_VIETSUB/$Zip_name
          credentials: ${{ secrets.eyJ3ZWIiOnsiY2xpZW50X2lkIjoiMjM4OTg3NTkxMzE0LWYxY2NtOXZ0OW5ybHFuNjY5dmczcTAyNmE5NGgzdHNiLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwicHJvamVjdF9pZCI6InByb3BhbmUtYXRyaXVtLTMyNjQyMyIsImF1dGhfdXJpIjoiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL2F1dGgiLCJ0b2tlbl91cmkiOiJodHRwczovL29hdXRoMi5nb29nbGVhcGlzLmNvbS90b2tlbiIsImF1dGhfcHJvdmlkZXJfeDUwOV9jZXJ0X3VybCI6Imh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL29hdXRoMi92MS9jZXJ0cyIsImNsaWVudF9zZWNyZXQiOiJHT0NTUFgtTGM3NThLT2Z0LVltSnZuWG1kOWZBSkQzREtoMCIsImphdmFzY3JpcHRfb3JpZ2lucyI6WyJodHRwOi8vbG9jYWxob3N0OjgwODAiXX19 }}
          parent_folder_id: 1WSbbk66UrylI0s3-Y5TVjqcahXFUpa9f
